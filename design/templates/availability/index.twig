{% extends "layout.twig" %}
{% block content %}
    <h2>
        {% trans %}TXT_AVAILABILITY_LIST{% endtrans %}
    </h2>

    <ul class="possibilities">
        <li>
            <a href="{{ path('admin.availability.add') }}" class="button"><span>{% trans %}TXT_ADD_AVAILABILITY{% endtrans %}</a>
        </li>
    </ul>

    <div class="block">
        <div id="list-availability"></div>
    </div>

    <script type="text/javascript">

        function editAvailability(dg, id) {
            location.href = '{{ path('admin.availability.edit') }}/' + id + '';
        }

        function deleteAvailability(dg, id) {
            var oRow = oDatagrid.GetRow(id);
            var title = '{% trans %}TXT_DELETE{% endtrans %}';
            var msg = '{% trans %}TXT_DELETE_CONFIRM{% endtrans %} <strong>' + oRow.name + '</strong> ?';
            var params = {
                dg: dg,
                id: id
            };
            var func = function (p) {
                return xajax_doDeleteAvailability(p.dg, p.id);
            };
            new GF_Alert(title, msg, func, true, params);
        }

        var oDatagrid;

        $(document).ready(function () {

            var column_id = new GF_Datagrid_Column({
                id: 'id',
                caption: '{% trans %}TXT_ID{% endtrans %}',
                appearance: {
                    width: 90,
                    visible: false
                },
                filter: {
                    type: GF_Datagrid.FILTER_BETWEEN
                }
            });

            var column_name = new GF_Datagrid_Column({
                id: 'name',
                caption: '{% trans %}TXT_NAME{% endtrans %}',
                appearance: {
                    width: 140
                },
                filter: {
                    type: GF_Datagrid.FILTER_INPUT
                }
            });

            var options = {
                id: 'availability',
                appearance: {
                    column_select: false
                },
                mechanics: {
                    key: 'id',
                    rows_per_page: 25
                },
                event_handlers: {
                    load: xajax_doLoadAvailability,
                    edit_row: editAvailability,
                    delete_row: deleteAvailability,
                    click_row: editAvailability
                },
                columns: [
                    column_id,
                    column_name
                ],
                row_actions: [
                    GF_Datagrid.ACTION_EDIT,
                    GF_Datagrid.ACTION_DELETE
                ],
                context_actions: [
                    GF_Datagrid.ACTION_EDIT,
                    GF_Datagrid.ACTION_DELETE
                ]
            };

            oDatagrid = new GF_Datagrid($('#list-availability'), options);

        });
    </script>
{% endblock %}
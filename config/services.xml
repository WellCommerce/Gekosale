<?xml version="1.0" encoding="UTF-8" ?>
<container
        xmlns="http://symfony.com/schema/dic/services"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
    
		<service id="request" synthetic="true" />
    
        <service id="cache.storage" class="Gekosale\Cache\Storage\File" />

        <service id="cache" class="Gekosale\Cache">
            <argument type="service" id="cache.storage" />
        </service>
        
        <service id="session.storage" class="Gekosale\Session\Storage\Database">
        	<argument type="service" id="service_container" />
        </service>
        
        <service id="session" class="Gekosale\Session">
            <argument type="service" id="session.storage" />
        </service>
        
        <service id="right" class="Gekosale\Right">
            <argument type="service" id="service_container" />
        </service>
        
        <service id="finder" class="Symfony\Component\Finder\Finder" />
        
        <service id="filesystem" class="Symfony\Component\Filesystem\Filesystem" />
        
        <service id="config.locator" class="Symfony\Component\Config\FileLocator">
            <argument>%application.root_path%config/Gekosale</argument>
        </service>

        <service id="router.loader" class="Symfony\Component\Routing\Loader\PhpFileLoader">
            <argument type="service" id="config.locator" />
        </service>

        <service id="router" class="Symfony\Component\Routing\Router">
            <argument type="service" id="router.loader" />
            <argument>routes.php</argument>
        </service>
        
        <service id="registry" class="Gekosale\Registry" />

		<service id="classmapper" class="Gekosale\ClassMapper">
            <argument type="service" id="service_container" />
        </service>
        
		<service id="dispatcher" class="Gekosale\EventDispatcher">
            <argument type="service" id="service_container" />
            <call method="addSubscribers" />
        </service>
        
		<service id="controller.resolver" class="Gekosale\Resolver\Controller">
			<argument type="service" id="service_container" />
        </service>
        
		<service id="model.resolver" class="Gekosale\Resolver\Model">
			<argument type="service" id="service_container" />
        </service>
        
		<service id="form.resolver" class="Gekosale\Resolver\Form">
			<argument type="service" id="service_container" />
        </service>
        
        <service id="kernel" class="Symfony\Component\HttpKernel\DependencyInjection\ContainerAwareHttpKernel">
            <argument type="service" id="dispatcher" />
            <argument type="service" id="service_container" />
            <argument type="service" id="controller.resolver" />
        </service>
                
        <service id="translation" class="Gekosale\Translation">
            <argument>%locale%</argument>
        </service>
        
        <service id="db" class="Gekosale\Db">
        	<argument type="service" id="service_container" />
            <argument>%database%</argument>
        </service>
    </services>
</container>